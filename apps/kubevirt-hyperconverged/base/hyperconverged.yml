apiVersion: hco.kubevirt.io/v1beta1
kind: HyperConverged
metadata:
  annotations:
    deployOVS: 'false'
  name: kubevirt-hyperconverged
spec:
  enableCommonBootImageImport: true
  virtualMachineOptions:
    disableFreePageReporting: false
    disableSerialConsoleLog: true
  higherWorkloadDensity:
    memoryOvercommitPercentage: 100
  liveMigrationConfig:
    allowAutoConverge: false
    allowPostCopy: false
    completionTimeoutPerGiB: 150
    parallelMigrationsPerCluster: 5
    parallelOutboundMigrationsPerNode: 2
    progressTimeout: 150
  certConfig:
    ca:
      duration: 48h0m0s
      renewBefore: 24h0m0s
    server:
      duration: 24h0m0s
      renewBefore: 12h0m0s
  enableApplicationAwareQuota: true
  applicationAwareConfig:
    allowApplicationAwareClusterResourceQuota: false
    vmiCalcConfigName: DedicatedVirtualResources
  featureGates:
    downwardMetrics: false
    disableMDevConfiguration: false
    deployKubeSecondaryDNS: true
    alignCPUs: false
    persistentReservation: false
    # enableMultiArchCommonBootImageImport: false
  # permittedHostDevices:
  #   usbHostDevices:
  #   - resourceName: kubevirt.io/zwave
  #     selectors:
  #     - vendor: "0658"
  #       product: "0200"
  workloadUpdateStrategy:
    batchEvictionInterval: 1m0s
    batchEvictionSize: 10
    workloadUpdateMethods:
    - LiveMigrate
  deployVmConsoleProxy: true
  uninstallStrategy: BlockUninstallIfWorkloadsExist
  resourceRequirements:
    vmiCPUAllocationRatio: 10
  vmStateStorageClass: ceph-filesystem
  obsoleteCPUs:
    minCPUModel: SapphireRapids
  # defaultCPUModel: SapphireRapids
  # oc -n kubevirt-hyperconverged get service dns-lb
  kubeSecondaryDNSNameServerIP: 10.42.41.102
  scratchSpaceStorageClass: ceph-filesystem
